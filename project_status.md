# AI工具导航网站项目状态

## 已完成功能
1. 基本的AI工具列表展示和详情页面
2. 工具搜索、分类筛选和标签系统
3. 数据持久化：从本地JSON迁移到MongoDB
4. 管理功能：添加、编辑、删除AI工具
5. 图片处理：集成Cloudinary，实现图标和截图上传
6. 用户界面优化：响应式设计，移动端体验优化
7. 页面布局优化：通用Layout组件，响应式导航栏
8. 工具访问统计：记录每个工具的访问次数
9. SEO优化：动态meta标签，站点地图生成，结构化数据
10. 错误处理和日志记录：集成winston日志系统
11. 用户系统：注册、登录、个人资料管理，JWT认证
12. 密码管理：密码强度检查，密码重置功能
13. 社交媒体经营策略文档
14. 性能优化：图片懒加载，数据获取逻辑优化
15. 用户角色系统：基于角色的访问控制
16. 项目结构现代化：采用Next.js 13+ App Router结构
17. 安全性增强：CSRF保护，密码强度检查
18. 开发工具集成：ESLint, Prettier配置
19. 自定义404页面
20. 邮件功能：使用Nodemailer发送密码重置邮件
21. API路由更新：适配Next.js 13+ App Router
22. 认证中间件更新：支持新的API路由结构
23. 用户资料更新功能：实现了EditProfileForm组件
24. 认证上下文优化：在AuthProvider中添加了updateUser功能
25. 动态路由处理：为用户资料API添加了动态路由支持
26. 实现了管理员仪表板：添加了AdminDashboard组件
27. 添加了密码强度指示器组件：PasswordStrengthIndicator
28. 实现了忘记密码功能：添加了ForgotPassword页面
29. 实现了用户评论和评分系统
30. 实现了评论的分页和排序功能
31. 实现了用户头像功能
32. 优化了评论区的视觉效果和用户体验
33. 修复了默认头像图片不显示的问题
34. 优化了评论组件的错误处理和用户体验
35. 修复了用户认证系统中的密码比较问题
36. 优化了评论提交的用户体验
37. 修复了评论API中的类型错误
38. 优化了密码比较和重置功能
39. 添加了密码重置功能的用户界面
40. 在工具详情页面添加了评论功能
    - 实现了评论提交表单
    - 集成了评论列表和评论提交功能
    - 优化了用户体验,包括评分选择和提交状态反馈
41. 修复了评论系统中的数据验证问题
    - 在后端API中添加了更严格的数据验证
    - 在前端添加了评论内容和评分的验证
    - 优化了评论模型,添加了更严格的数据验证规则
42. 实现了评论数据清理功能
    - 创建了脚本以检查和清理无效的评论数据
    - 添加了用户交互,允许管理员选择是否删除无效评论
43. 改进了评论提交的错误处理
    - 在前端添加了更详细的错误信息显示
    - 在后端添加了更多的日志记录,便于调试
44. 优化了认证中间件
    - 添加了更详细的日志记录
    - 改进了错误处理和用户反馈
45. 实现了评论编辑功能
    - 添加了EditCommentForm组件
    - 在CommentSection组件中集成了编辑功能
    - 实现了后端API支持评论编辑
46. 修复了评论区用户名和头像不显示的问题
    - 更新了评论API以正确返回用户信息
    - 修改了CommentSection组件以显示用户头像和名称
47. 修复了评论区的TypeScript类型错误
    - 更新了AITool.ts中的Comment接口,添加了user.id字段
    - 修改了CommentSection组件以适应新的类型定义
    - 确保API返回的评论数据包含正确的用户ID
48. 实现了评论的点赞/踩功能
    - 更新了Comment接口和数据模型,添加了点赞和踩的字段
    - 在CommentSection组件中添加了点赞/踩按钮和相关逻辑
    - 创建了新的API路由来处理点赞/踩操作
    - 更新了评论获取API,以包含点赞/踩信息
49. 修复了评论点赞/踩功能的认证问题
    - 在前端请求中添加了认证令牌
    - 确保后端API正确使用了authMiddleware
    - 添加了用户未登录时的错误处理
50. 修复了评论点赞/踩功能中的错误
    - 在AITool模型中添加了userReactions字段
    - 修改了reaction API路由以处理userReactions可能不存在的情况
    - 确保在访问userReactions之前进行了适当的检查
51. 实现了评论的搜索功能
    - 在后端 API 中添加了搜索过滤器
    - 在 CommentSection 组件中添加了搜索输入框
    - 实现了实时搜索功能,随着用户输入自动更新评论列表
52. 实现了评论的举报功能
    - 在CommentSection组件中添加了举报按钮
    - 创建了新的API路由来处理评论举报
    - 更新了AITool模型以包含评论举报信息
    - 创建了管理员界面来查看和处理被举报评论
    - 实现了管理员删除或忽略被举报评论的功能
53. 完善了评论的举报功能
    - 更新了User模型,确保包含role字段用于区分管理员和普通用户
    - 完善了管理员查看被举报评论的API,添加了用户角色验证
    - 优化了ReportedComments组件,使用类型断言解决TypeScript错误
    - 在AITool模型中添加了reports字段,用于存储举报信息
54. 优化了评论的加载性能
    - 实现了评论的分页加载
    - 添加了评论排序功能
    - 实现了评论搜索功能,支持实时搜索
55. 完善了错误处理机制
    - 在API路由中添加了更详细的错误日志记录
    - 优化了前端错误提示,提供更友好的用户体验
56. 增强了项目的类型安全性
    - 更新了AITool和Comment接口定义
    - 在API路由中添加了更严格的类型检查
57. 改进了项目的安全性
    - 在评论相关的API中添加了认证中间件
    - 实现了基于角色的访问控制,特别是对管理员功能的保护
58. 优化了项目结构
    - 采用了Next.js 13+ App Router结构
    - 将API路由迁移到新的app目录结构中
59. 添加了更多的开发工具和脚本
    - 添加了评论数据检查和清理脚本
    - 更新了数据迁移脚本,支持新的数据模型
60. 优化了用户资料更新功能
    - 在AuthProvider中完善了updateUser函数的实现
    - 改进了EditProfileForm组件,添加了错误处理
    - 优化了ProfilePage,实现了编辑后自动刷新用户数据
    - 完善了用户资料API路由,确保正确处理更新请求
61. 实现了用户头像上传功能
    - 在EditProfileForm组件中添加了头像上传功能
    - 更新了ProfilePage以显示用户头像
    - 修改了用户资料API以支持头像URL的更新
    - 确保User模型包含avatarUrl字段
62. 优化了项目构建过程
    - 成功完成了生产环境的构建
    - 生成了静态页面和动态路由
    - 自动生成了站点地图
63. 修复了 CommentSection 组件中的 useEffect 依赖警告
    - 使用 useCallback 优化了 fetchComments 函数
    - 正确设置了 useEffect 的依赖项
64. 更新了 next.config.js 配置
    - 移除了过时的 experimental.appDir 选项
    - 优化了 Sentry 配置
    - 保留了 Cloudinary 图片域名配置
65. 优化了图片上传和预览功能
    - 重构了 ImageUpload 组件，使用 lazy 加载和 Suspense 优化性能
    - 添加了 ImagePreview 组件，用于显示上传后的图片预览
    - 在 EditProfileForm 和 AddToolPage 中集成了新的图片上传功能
66. 改进了评论系统的性能和用户体验
    - 使用 lazy 加载和 Suspense 优化了 CommentForm 和 EditCommentForm 组件
    - 实现了评论的实时搜索和排序功能
    - 优化了评论的分页加载
67. 增强了工具详情页面的加载性能
    - 使用 dynamic import 和 Suspense 优化了 ToolDetailContent 和 CommentSection 的加载
    - 实现了元数据的动态生成，提高了SEO效果
68. 实现了评论的回复功能
    - 更新了AITool模型以支持嵌套评论
    - 在CommentSection组件中添加了回复显示和处理逻辑
    - 创建了ReplyForm组件用于提交回复
    - 添加了处理回复的API路由
    - 更新了相关的类型定义
69. 完善了评论回复功能
    - 更新了 AITool 模型，确保每个评论都有 replies 字段
    - 在 CommentSection 组件中实现了回复的显示和提交功能
    - 创建了专门的 API 路由处理回复的提交
    - 更新了类型定义，确保 TypeScript 类型安全
    - 实现了回复的用户头像和用户名显示
70. 优化了评论系统的用户体验
    - 使用 Suspense 和 lazy 加载优化了评论表单和回复表单的加载
    - 改进了评论和回复的样式，提高了可读性
    - 实现了回复的实时更新，无需刷新页面
71. 增强了数据一致性和错误处理
    - 在 API 路由中添加了更多的错误检查和处理
    - 确保在保存回复时同时更新数据库和前端状态
    - 优化了错误信息的显示，提供更友好的用户反馈
72. 实现了评论回复的编辑和删除功能
    - 更新了ReplyForm组件,支持编辑模式
    - 在CommentSection组件中添加了回复的编辑和删除按钮
    - 创建了新的API路由来处理回复的编辑和删除
    - 实现了前端状态更新,确保实时反映编辑和删除操作
    - 添加了用户权限检查,只允许回复作者和管理员进行编辑和删除操作
73. 修复了回复功能的验证错误
    - 更新了 AITool 模型中的 Reply 模式，添加了必需的 username 字段
    - 修改了添加回复的 API 路由，确保包含 username
    - 更新了 CommentSection 组件以适应新的回复格式
    - 确保了数据一致性和模型验证
74. 修复了回复功能中的 username 验证错误
    - 更新了 AITool 模型中的 ReplySchema，为 username 字段添加了默认值
    - 创建并运行了数据迁移脚本，为现有回复添加缺失的 username
    - 更新了添加回复的 API 路由，确保始终包含 username
    - 修改了 CommentSection 组件，以处理可能缺少 username 的情况
    - 增强了数据一致性，确保所有回复都有有效的 username
75. 实现了基本的管理员仪表板
    - 创建了管理员主页，显示用户、AI工具和被举报评论的概览
    - 实现了用户管理页面，可以查看所有用户信息
    - 添加了获取用户列表和被举报评论的API路由
    - 使用AdminRoute组件确保只有管理员可以访问这些页面
76. 优化了评论系统的性能和用户体验
    - 实现了评论的分页加载
    - 添加了评论排序功能（最新、最早、评分高低）
    - 实现了评论搜索功能，支持实时搜索
    - 实现了定期自动刷新评论
    - 添加了页面可见性变化时的评论刷新
77. 改进了评论和回复的数据结构
    - 更新了 Comment 和 Reply 接口定义，确保类型安全
    - 优化了后端 API 返回的数据结构，确保前端能正确显示用户信息
78. 增强了评论系统的功能
    - 实现了评论编辑功能
    - 添加了评论删除功能
    - 实现了评论回复功能，包括添加、编辑和删除回复
79. 改进了错误处理和日志记录
    - 在前端添加了更详细的错误处理和用户反馈
    - 在后端 API 中增加了日志记录，便于调试
80. 增强了用户交互体验
    - 添加了评论点赞/踩功能
    - 实现了评论举报功能
81. 完善了评论举报功能
    - 更新了 AITool 模型，在 CommentSchema 中添加了 reports 字段
    - 在 Comment 接口中添加了 reports 字段，用于存储举报信息
    - 创建了 Report 接口，定义了举报的数据结构
    - 在 CommentList 组件中实现了举报按钮和相关逻辑
82. 重构了评论系统的组件结构
    - 创建了 useCommentActions 自定义 hook，抽离评论交互逻辑
    - 更新了 CommentSection 组件，使用新的 hook 和结构
    - 重构了 CommentList 组件，改进了props和渲染逻辑
    - 优化了评论和回复的显示样式
83. 修复了评论系统的数据模型和API问题
    - 更新了 AITool 模型，正确定义了 comments 字段
    - 修改了评论 API 路由，解决了 populate 错误
    - 创建并运行了数据迁移脚本，确保所有现有文档都有正确的 comments 字段
    - 优化了评论的添加、获取、更新和删除功能
84. 改进了评论系统的错误处理和日志记录
    - 在评论 API 路由中添加了更详细的错误日志
    - 优化了错误响应，提供更具体的错误信息
85. 增强了评论系统的性能
    - 使用 findOneAndUpdate 方法优化了评论添加过程
    - 实现了评论数据的批量更新，减少数据库操作次数
86. 修复了评论回复功能的问题
    - 更新了 AITool 模型中的 ReplySchema，确保所有必需字段都被正确定义
    - 修改了评论回复 API 路由，解决了类型错误和数据验证问题
    - 优化了错误处理和日志记录，提供更详细的错误信息
    - 使用 markModified 确保 Mongoose 正确识别嵌套文档的更改
87. 改进了评论回复的用户体验
    - 在 CommentSection 组件中实现了更流畅的回复交互
    - 优化了 ReplyForm 组件，添加了取消功能
    - 确保回复成功后自动刷新评论列表
88. 增强了数据一致性
    - 在添加回复时使用 findById 和 save 方法，而不是 findOneAndUpdate
    - 确保在保存回复时包含了所有必要的用户信息
89. 集成了 Vercel Web Analytics
    - 在 Vercel 仪表板中启用了 Web Analytics
    - 安装了 @vercel/analytics 包
    - 在根布局文件中添加了 Analytics 组件
    - 部署应用并验证了分析功能的正常工作
90. 集成了 Vercel Speed Insights
    - 在 Vercel 仪表板中启用了 Speed Insights
    - 安装了 @vercel/speed-insights 包
    - 在根布局文件中添加了 SpeedInsights 组件
    - 部署应用并验证了 Speed Insights 功能的正常工作
91. 优化了评论系统的移动端显示
    - 在 CommentSection 和 CommentList 组件中添加了响应式设计
    - 使用 Tailwind CSS 的移动端优先类调整了布局和字体大小
    - 优化了按钮和输入框在移动设备上的可用性
92. 修复了评论回复功能的问题
    - 在 CommentSection 组件中正确处理回复状态
    - 确保点击回复按钮后显示回复输入框
    - 优化了 ReplyForm 组件的显示和提交逻辑
    - 添加了回复内容验证，防止提交空回复
93. 修复了评论回复功能的认证问题
    - 优化了 ReplyForm 组件中的错误处理
    - 改进了 authMiddleware 中的 token 验证逻辑
    - 更新了评论回复 API 路由以正确使用 authMiddleware
    - 增加了更详细的错误日志记录
94. 修复了评论回复功能中的用户名缺失问题
    - 在回复API中添加了获取用户信息的逻辑
    - 确保在添加回复时包含用户名和头像URL
    - 更新了AITool模型中的ReplySchema，确保username字段为必填
95. 优化了评论回复的错误处理和用户体验
    - 在ReplyForm组件中添加了更详细的错误处理和用户反馈
    - 确保用户登录后才能提交回复
    - 改进了回复提交失败时的错误信息显示
96. 修复了评论反应（点赞/踩）功能的路由处理问题
    - 在 reaction API 路由中添加了适当的响应返回
    - 确保在所有情况下都返回 NextResponse
    - 增加了错误处理和日志记录
97. 优化了评论点赞/踩功能的用户体验
    - 实现了点赞/踩的即时反馈
    - 优化了 useCommentActions hook 以处理单个评论的更新
    - 更新了 CommentList 组件以反映点赞状态的即时变化
    - 改进了 CommentSection 组件的状态管理，实现了局部更新
98. 修复了管理员通知 API 的类型错误
    - 更正了 PUT 方法中 authMiddleware 的使用方式
    - 确保了 GET 和 PUT 方法的一致性
    - 优化了错误处理和日志记录
99. 修复了被举报评论 API 的类型错误
    - 更新了 GET 方法的返回类型
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理
100. 修复了评论回复编辑和删除 API 的类型错误
    - 更新了 PUT 和 DELETE 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
101. 修复了评论举报 API 的类型错误
    - 更新了 POST 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
102. 修复了评论添加 API 的类型错误
    - 更新了 POST 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
103. 修复了评论删除 API 的类型错误
    - 更新了 DELETE 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
104. 修复了工具添加 API 的类型错误
    - 更新了 POST 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
105. 修复了工具更新和删除 API 的类型错误
    - 更新了 PUT 和 DELETE 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
106. 修复了用户资料 API 的类型错误
    - 更新了 GET 和 PUT 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录
107. 修复了用户资料更新 API 的类型错误
    - 更新了 PUT 方法的返回类型
    - 添加了用户权限检查
    - 确保了与其他 API 路由的一致性
    - 优化了错误处理和日志记录

## 需要解决的问题和下一步计划

1. 评论系统进一步优化
   - 实现评论的无限滚动加载，替代当前的分页方式
   - 优化大量评论和回复时的加载性能
   - 实现评论的热度排序算法
   - 考虑实现评论内容的富文本编辑
   - 添加评论的多语言支持
   - 优化移动端的评论显示和交互体验
     * 调整评论布局,确保在小屏幕设备上易于阅读
     * 优化评论输入框,提高移动端用户的输入体验
     * 实现手势操作,如滑动回复或点赞
     * 优化评论加载性能,考虑使用虚拟滚动技术

2. 用户体验改进
   - 确保所有评论和回复的用户头像都能正确显示
   - 添加用户评论历史页面，允许用户查看和管理自己的所有评论
   - 优化评论提交的用户体验，包括实时预览和草稿保存功能

3. 后端功能完善
   - 实现评论举报的后端处理逻辑
   - 实现评论的举报管理系统，包括管理员审核界面
   - 完善评论举报功能，包括后端处理逻辑和管理员审核流程
   - 实现评论数据的缓存策略，减少数据库查询压力

4. 数据分析和性能优化
   - 添加论的数据分析功能，如评论情感分析、用户活跃度分析等
   - 实现评论相关的数据库查询优化，考虑使用索引提高性能
   - 监控和优化评论系统在生产环境中的性能表现

5. 测试和安全
   - 添加更多的单元测试和集成测试，特别是针对新添加的评论功能
   - 实现评论的审核机制，防止垃圾评论和不当内容
   - 加强用户数据的隐私保护，确保符合相关法规要求

## 技术债务

1. 代码重构
   - ✓ 重构 CommentSection 组件，将部分逻辑抽离为自定义 hooks
   - 继续优化 useCommentActions hook，考虑将其拆分为更小的专用hooks
   - 重构 CommentForm 组件，使用新的 hook 结构

2. 依赖管理
   - 更新依赖包版本，特别是 Next.js 和 React

3. 文档和注释
   - 为 AITool 模型添加详细的字段说明和使用注释
   - 更新 API 文档，反映最新的评论系统变更
   - ✓ 更新项目状态文档，记录最近的bug修复和改进

4. 开发流程优化
   - 建立更严格的代码审查流程
   - 优化开发环境，提高开发效率

5. 监控和日志
   - 完善错误监控和日志系统，便于问题定位和性能优化

## 注意事项
- 密切关注生产环境中评论系统的性能表现
- 定期检查和分析日志，及时发现和解决潜在问题
- 监控评论举报功能的使用情况，及时调整策略以防滥用
- 注意用户数据的隐私保护，确保符合相关法规要求
- 定期运行数据一致性检查，确保所有 AI 工具文档都有正确的 comments 字段结构
- 监控评论系统的性能，特别是在高并发情况下的表现
- 定期查看 Vercel Analytics 数据，了解用户行为和网站性能
- 确保遵守数据隐私法规，如 GDPR
- 定期查看 Vercel Speed Insights 数据,了解网站性能指标和用户体验
- 根据 Speed Insights 的建议,持续优化网站性能

## 长期目标
1. 建立活跃的用户社区，鼓励用户分享和讨论AI工具
2. 考虑与AI工具提供商合作，提供独家优惠或集成服务
3. 开发API，允许第三方开发者接入我们的AI工具数据库
4. 探索AI相关的新兴领域，扩展网站内容
5. 考虑开发移动应用，为用户提供更便捷的访问方式
6. 实现高级数据分析和机器学习功能，为用户推荐个性化的AI工具
7. 建立AI工具评估和认证体系，提高平台的权威性和可信度
8. 实现评论数据的高级分析功能，如情感分析和用户行为预测

## 项目文件结构
ai-tools-navigator/
├── .env.local                 # 本地环境变量配置文件
├── .eslintrc.json             # ESLint 配置文件
├── .gitignore                 # Git 忽略文件配置
├── next.config.js            # Next.js 配置文件，包含图片域名和 Sentry 设置
├── package.json               # 项目依赖和脚本配置
├── postcss.config.js          # PostCSS 配置文件
├── README.md                  # 项目说明文档
├── tailwind.config.js         # Tailwind CSS 配置文件
├── tsconfig.json              # TypeScript 配置文件
├── public/                    # 静态资源目录
│   └── favicon.ico            # 网站图标
├── scripts/                   # 脚本目录
│   ├── importData.ts          # 数据导入脚本
│   ├── migrateToMongoDB.ts    # MongoDB 数据迁移脚本
│   ├── migrateReplies.ts      # 回复数据迁移脚本
│   └── updateAIToolsSchema.ts  # AITool 模型更新脚本
├── src/                       # 源代码目录
│   ├── app/                   # Next.js 13+ App Router 目录
│   │   ├── admin/             # 管理员相关页面
│   │   │   ├── tools/         # 工具相关 API
 │   │   │   │   ├── [id]/     # 工具详情页面
 │   │   │   │   │   └── comments/ # 评论相关 API
 │   │   │   │   │   │   └── [commentId]/ # 评论详情页面
 │   │   │   │   │   │   │   └── reply/ # 回复相关 API
 │   │   │   │   │   │   │   │   └── [replyId]/ # 回复详情页面
 │   │   │   │   │   │   │   │   │   └── route.ts # 处理评论回复的 API 路由
 │   │   │   │   │   │   │   └── route.ts    # 处理评论回复的 API 路由
 │   │   │   └── users/         # 用户相关 API
 │   │   ├── login/             # 登录页面
 │   │   ├── profile/           # 用户资料页面
 │   │   ├── submit-tool/       # 提交工具页面
 │   │   ├── tools/             # 工具详情页面
 │   │   ├── global-error.js    # 全局错误处理
 │   │   ├── layout.tsx         # 全局布局组件
 │   │   ├── not-found.tsx      # 404 页面
 │   │   └── page.tsx           # 首页
 │   ├── components/            # React 组件目录
 │   │   ├── AdminRoute.tsx     # 管理员路由保护组件
 │   │   ├── AIToolCard.tsx     # AI 工具卡片组件
 │   │   ├── AIToolListWrapper.tsx # AI 工具列表包装器
 │   │   ├── AuthProvider.tsx   # 认证提供者组件
 │   │   ├── CloudinaryCheck.tsx # Cloudinary 配置检查组件
 │   │   ├── ErrorBoundary.tsx  # 错误边界组件
 │   │   ├── ImageUpload.tsx    # 图片上传组件
 │   │   ├── Layout.tsx         # 布局组件
 │   │   ├── LoadingSpinner.tsx # 加载动画组件
 │   │   ├── NavMenu.tsx        # 导航菜单组件
 │   │   ├── ReplyForm.tsx      # 回复表单组件
 │   │   ├── PasswordStrengthIndicator.tsx # 密码强度指示器
 │   │   ├── EditProfileForm.tsx # 用户资料编辑表单组件
 │   │   └── ...
 │   ├── lib/                   # 库文件目录
 │   │   └── dbConnect.ts       # 数据库连接函数
 │   ├── middleware/            # 中间件目录
 │   │   ├── errorHandler.ts    # 错误处理中间件
 │   │   └── roleMiddleware.ts  # 角色中间件
 │   ├── models/                # 数据模型目录
 │   │   ├── AITool.ts          # AI 工具模型
 │   │   ├── ErrorLog.ts        # 错误日志模型
 │   │   └── User.ts            # 用户模型
 │   ├── types/                 # 类型定义目录
 │   │   ├── user.ts            # 用户相关类型定义
 │   │   └── next.d.ts          # Next.js 类型扩展
 │   └── utils/                 # 工具函数目录
 │       ├── apiErrors.ts       # API 错误处理工具
 │       ├── auth.ts            # 认证相关工具
 │       ├── emailTemplates.ts  # 邮件模板
 │       └── logger.ts          # 日志工具
 └── stories/                   # Storybook 组件故事目录
     └── Button.stories.ts      # 按钮组件故事

## 文件结构说明

1. 根目录文件：包含项目配置、环境变量、依赖管理等基础设置。
2. public/：存放静态资源，如网站图标。
3. scripts/：包含数据导入和迁移脚本，用于初始化和维护数据。
4. src/：主要源代码目录。
   - app/：Next.js 13+ 的 App Router 结构，包含所有页面和 API 路由。
   - components/：可复用的 React 组件。
   - components/ReplyForm.tsx：新增的评论回复表单组件，用于用户提交回复。
- app/api/tools/[id]/comments/[commentId]/reply/[replyId]/route.ts：新增的 API 路由，处理评论回复的编辑和删除。
   - lib/：核心库文件，如数据库连接。
   - middleware/：中间件，用于请求处理和错误捕获。
   - models/：数据库模型定义。
   - types/：TypeScript 类型定义。
   - utils/：通用工具函数和辅助方法。
5. stories/：Storybook 组件故事，用于组件开发和测试。

这个文件结构反映了一个典型的 Next.js 项目，采用了模块化和关注点分离的原则。它将不同功能的代码分开存放，便于维护和扩展。在调试错误时，可以根据错误的性质快速定位到相关的文件或目录：

- 页面渲染问题：查看 src/app/ 下的相关页面文件
- API 错误：检查 src/app/api/ 下的相关路由
- 数据库问题：查看 src/models/ 和 src/lib/dbConnect.ts
- 组件问题：检查 src/components/ 目录
- 认证问题：查看 src/utils/auth.ts 和相关的 API 路由
- 全局错误：检查 src/app/global-error.js 和 src/middleware/errorHandler.ts

在进行错误排查时，可以先确定错误的类型（如前端渲染、API 请求、数据库操作等），然后根据这个文件结构快速定位到可能出问题的文件或模块。特别注意新的API路由结构和认证中间件的变化。

## 最近更新
- 集成了 Vercel Speed Insights,提供了详细的网站性能分析
- 优化了评论回复功能,提高了用户交互体验
- 实现了基本的管理员仪表板,增强了网站的管理能力
- 改进了评论系统的移动端适配,提升了小屏幕设备的用户体验

